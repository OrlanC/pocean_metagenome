library(phyloseq)
library(ggplot2)
library(ggplot2)
library(dplyr)
library(scales)
library(RColorBrewer)
library(ggpubr)
library(readr)
library(patchwork)
# Read the biom file
raw_biom <- import_biom("~/dc_workshop/pocean_metagenome/data/pacific_ocean.biom")
#Give name to taxonomic categories
raw_biom@tax_table@.Data<-substring(raw_biom@tax_table@.Data,4)
colnames(raw_biom@tax_table@.Data)<- c("Kingdom","Phylum", "Class", "Order","Family", "Genus", "Species")
View(raw_biom)
# Read metadata
metadatos<-read.csv("~/dc_workshop/pocean_metagenome/data/metadata_sampling.csv")
row.names(metadatos) <- metadatos$ID
View(metadatos)
metadatos
metadatos$Zone<-factor(metadatos$Zone, levels = c("Epipelagic", "Mesopelagic", "Abyssopelagic"))
levels(metadatos$Zone)<-c("Epipelagic", "Mesopelagic", "Abyssopelagic")
# Generate otu_table
otu<-otu_table(raw_biom@otu_table@.Data, taxa_are_rows = TRUE)
colnames(otu) <-metadatos$ID
# Generate taxonomy table
tax<-tax_table(raw_biom@tax_table@.Data)
# Generate metadata table
metad<-sample_data(metadatos)
# It is the complete phyloseq object with the 3 previous tables
global<-phyloseq(otu, tax, metad)
library(phyloseq)
# Read the biom file
raw_biom <- import_biom("~/dc_workshop/pocean_metagenome/data/pacific_ocean.biom")
#Give name to taxonomic categories
raw_biom@tax_table@.Data<-substring(raw_biom@tax_table@.Data,4)
colnames(raw_biom@tax_table@.Data)<- c("Kingdom","Phylum", "Class", "Order","Family", "Genus", "Species")
# Read metadata
metadatos<-read.csv("~/dc_workshop/pocean_metagenome/data/metadata_sampling.csv")
row.names(metadatos) <- metadatos$ID
metadatos$Zone<-factor(metadatos$Zone, levels = c("Epipelagic", "Mesopelagic", "Abyssopelagic"))
levels(metadatos$Zone)<-c("Epipelagic", "Mesopelagic", "Abyssopelagic")
# Generate otu_table
otu<-otu_table(raw_biom@otu_table@.Data, taxa_are_rows = TRUE)
colnames(otu) <-metadatos$ID
# Generate taxonomy table
tax<-tax_table(raw_biom@tax_table@.Data)
# Generate metadata table
metad<-sample_data(metadatos)
View(metad)
# It is the complete phyloseq object with the 3 previous tables
global<-phyloseq(otu, tax, metad)
metadatos
# Read the biom file
raw_biom <- import_biom("~/dc_workshop/pocean_metagenome/data/pacific_ocean.biom")
#Give name to taxonomic categories
raw_biom@tax_table@.Data<-substring(raw_biom@tax_table@.Data,4)
colnames(raw_biom@tax_table@.Data)<- c("Kingdom","Phylum", "Class", "Order","Family", "Genus", "Species")
# Read metadata
metadatos<-read.csv("~/dc_workshop/pocean_metagenome/data/metadata_sampling.csv")
row.names(metadatos) <- metadatos$ID
metadatos$Zone<-factor(metadatos$Zone, levels = c("Epipelagic", "Mesopelagic", "Abyssopelagic"))
# Generate otu_table
otu<-otu_table(raw_biom@otu_table@.Data, taxa_are_rows = TRUE)
colnames(otu) <-metadatos$ID
# Generate taxonomy table
tax<-tax_table(raw_biom@tax_table@.Data)
# Generate metadata table
metad<-sample_data(metadatos)
View(metad)
# It is the complete phyloseq object with the 3 previous tables
global<-phyloseq(otu, tax, metad)
# Generate metadata table
metad<-sample_names(metadatos)
# Generate metadata table
metad<-sample_names(metadatos)
# Generate metadata table
metad<-sample_names(metadatos)
# It is the complete phyloseq object with the 3 previous tables
global<-phyloseq(otu, tax, metad)
View(otu)
View(tax)
View(metadatos)
# Read metadata
metadatos<-read.csv("~/dc_workshop/pocean_metagenome/data/metadata_sampling.csv")
row.names(metadatos) <- metadatos$Samples
metadatos$Zone<-factor(metadatos$Zone, levels = c("Epipelagic", "Mesopelagic", "Abyssopelagic"))
# Generate otu_table
otu<-otu_table(raw_biom@otu_table@.Data, taxa_are_rows = TRUE)
colnames(otu) <-metadatos$Samples
# Generate taxonomy table
tax<-tax_table(raw_biom@tax_table@.Data)
# Generate metadata table
metad<-sample_data(metadatos)
# It is the complete phyloseq object with the 3 previous tables
global<-phyloseq(otu, tax, metad)
# Put the complete species names in the column for Species (instead of the epithet only)
global@tax_table@.Data[,7]<-paste(global@tax_table@.Data[,6], global@tax_table@.Data[,7], sep= "_")
View(global)
global$tax
global@tax_table
global@tax_table@.Data
head(global@tax_table@.Data)
#Relative abundance
phylum_global<- tax_glom(global, "Phylum") # Agglomerate at Phylum level
View(phylum_global)
relative_phylum_global<- transform_sample_counts(phylum_global, function(x) x / sum(x) ) #Transform to relative abundance
rel_phyl_global_df<-psmelt(relative_phylum_global) # convert to data frame
View(rel_phyl_global_df)
rel_phyl_global_df$Sample
head(rel_phyl_global_df$Sample)
View(raw_biom)
rel_phyl_global_df$Phylum<- as.character(rel_phyl_global_df$Phylum) # convert to character type
rel_phyl_global_df$Phylum[rel_phyl_global_df$Abundance < 0.01] <- "Fila < 1% de abundancia" # Agglomerate in one name all the phyla with little abundance
rel_phyl_global_df$Phylum<- as.factor(rel_phyl_global_df$Phylum) # convert to factor type
rel_phyl_global_df$Sample<- factor(rel_phyl_global_df$Sample, levels = c("SRR5788415", "SRR5788416", "SRR5788417", "SRR5788420", "SRR5788421", "SRR5788422"))  # Put Sample Type levels in chosen object to coincide with corresponding sample ID order
#Make the abundance plot by samples
phylum_colors<- brewer.pal(length(levels(rel_phyl_global_df$Phylum)),"Dark2")
global_rel_phyl_plot<-ggplot(rel_phyl_global_df, aes(x=Sample, y=Abundance, fill=Phylum)) +
geom_bar(aes(), stat="identity", position="stack") +
scale_fill_manual(values=phylum_colors) +
labs(x= "Muestras", y = "Abundancia relativa") +
facet_grid(~Zone, scales = "free_x")
ggsave("abund_rel_phyl_global.png", plot = global_rel_phyl_plot, width = 6.5, height = 3.65, units = "in", dpi = 400)
global_rel_phyl_plot
#Relative abundance
phylum_global<- tax_glom(global, "Phylum") # Agglomerate at Phylum level
relative_phylum_global<- transform_sample_counts(phylum_global, function(x) x / sum(x) ) #Transform to relative abundance
rel_phyl_global_df<-psmelt(relative_phylum_global) # convert to data frame
rel_phyl_global_df$Phylum<- as.character(rel_phyl_global_df$Phylum) # convert to character type
rel_phyl_global_df$Phylum[rel_phyl_global_df$Abundance < 0.01] <- "Fila < 1% de abundancia" # Agglomerate in one name all the phyla with little abundance
rel_phyl_global_df$Phylum<- as.factor(rel_phyl_global_df$Phylum) # convert to factor type
rel_phyl_global_df$Samples<- factor(rel_phyl_global_df$Samples, levels = c("SRR5788415", "SRR5788416", "SRR5788417", "SRR5788420", "SRR5788421", "SRR5788422"))  # Put Sample Type levels in chosen object to coincide with corresponding sample ID order
#Relative abundance
phylum_global<- tax_glom(global, "Phylum") # Agglomerate at Phylum level
relative_phylum_global<- transform_sample_counts(phylum_global, function(x) x / sum(x) ) #Transform to relative abundance
rel_phyl_global_df<-psmelt(relative_phylum_global) # convert to data frame
rel_phyl_global_df$Phylum<- as.character(rel_phyl_global_df$Phylum) # convert to character type
rel_phyl_global_df$Phylum[rel_phyl_global_df$Abundance < 0.01] <- "Fila < 1% de abundancia" # Agglomerate in one name all the phyla with little abundance
rel_phyl_global_df$Phylum<- as.factor(rel_phyl_global_df$Phylum) # convert to factor type
rel_phyl_global_df$Samples<- as.factor(rel_phyl_global_df$Samples, levels = c("SRR5788415", "SRR5788416", "SRR5788417", "SRR5788420", "SRR5788421", "SRR5788422"))  # Put Sample Type levels in chosen object to coincide with corresponding sample ID order
View(metadatos)
View(relative_phylum_global)
View(relative_phylum_global@tax_table@.Data)
View(relative_phylum_global@otu_table@.Data)
head(rel_phyl_global_df$Sample)
rel_phyl_global_df$Samples<- factor(rel_phyl_global_df$Samples, levels = c("SRR5788415 ", "SRR5788416 ", "SRR5788417 ", "SRR5788420 ", "SRR5788421 ", "SRR5788422 "))  # Put Sample Type levels in chosen object to coincide with corresponding sample ID order
#Make the abundance plot by samples
phylum_colors<- brewer.pal(length(levels(rel_phyl_global_df$Phylum)),"Dark2")
global_rel_phyl_plot<-ggplot(rel_phyl_global_df, aes(x=Samples, y=Abundance, fill=Phylum)) +
geom_bar(aes(), stat="identity", position="stack") +
scale_fill_manual(values=phylum_colors) +
labs(x= "Muestras", y = "Abundancia relativa") +
facet_grid(~Zone, scales = "free_x")
ggsave("abund_rel_phyl_global.png", plot = global_rel_phyl_plot, width = 6.5, height = 3.65, units = "in", dpi = 400)
global_rel_phyl_plot
head(rel_phyl_global_df$Sample)
rel_phyl_global_df$Samples<- factor(rel_phyl_global_df$Samples, levels = c("SRR5788415 ", "SRR5788416 ", "SRR5788417 ", "SRR5788420  ", "SRR5788421  ", "SRR5788422  "))  # Put Sample Type levels in chosen object to coincide with corresponding sample ID order
#Make the abundance plot by samples
phylum_colors<- brewer.pal(length(levels(rel_phyl_global_df$Phylum)),"Dark2")
global_rel_phyl_plot<-ggplot(rel_phyl_global_df, aes(x=Samples, y=Abundance, fill=Phylum)) +
geom_bar(aes(), stat="identity", position="stack") +
scale_fill_manual(values=phylum_colors) +
labs(x= "Muestras", y = "Abundancia relativa") +
facet_grid(~Zone, scales = "free_x")
ggsave("abund_rel_phyl_global.png", plot = global_rel_phyl_plot, width = 6.5, height = 3.65, units = "in", dpi = 400)
global_rel_phyl_plot
View(metadatos)
metadatos
# Read the biom file
raw_biom <- import_biom("~/dc_workshop/pocean_metagenome/data/pacific_ocean.biom")
#Give name to taxonomic categories
raw_biom@tax_table@.Data<-substring(raw_biom@tax_table@.Data,4)
colnames(raw_biom@tax_table@.Data)<- c("Kingdom","Phylum", "Class", "Order","Family", "Genus", "Species")
# Read metadata
metadatos<-read.csv("~/dc_workshop/pocean_metagenome/data/metadata_sampling.csv")
row.names(metadatos) <- metadatos$Samples
metadatos$Zone<-factor(metadatos$Zone, levels = c("Epipelagic", "Mesopelagic", "Abyssopelagic"))
# Generate otu_table
otu<-otu_table(raw_biom@otu_table@.Data, taxa_are_rows = TRUE)
colnames(otu) <-metadatos$Samples
# Generate taxonomy table
tax<-tax_table(raw_biom@tax_table@.Data)
# Generate metadata table
metad<-sample_data(metadatos)
# It is the complete phyloseq object with the 3 previous tables
global<-phyloseq(otu, tax, metad)
# Put the complete species names in the column for Species (instead of the epithet only)
global@tax_table@.Data[,7]<-paste(global@tax_table@.Data[,6], global@tax_table@.Data[,7], sep= "_")
#Relative abundance
phylum_global<- tax_glom(global, "Phylum") # Agglomerate at Phylum level
relative_phylum_global<- transform_sample_counts(phylum_global, function(x) x / sum(x) ) #Transform to relative abundance
rel_phyl_global_df<-psmelt(relative_phylum_global) # convert to data frame
rel_phyl_global_df$Phylum<- as.character(rel_phyl_global_df$Phylum) # convert to character type
rel_phyl_global_df$Phylum[rel_phyl_global_df$Abundance < 0.01] <- "Fila < 1% de abundancia" # Agglomerate in one name all the phyla with little abundance
rel_phyl_global_df$Phylum<- as.factor(rel_phyl_global_df$Phylum) # convert to factor type
rel_phyl_global_df$Samples<- factor(rel_phyl_global_df$Samples, levels = c("SRR5788415", "SRR5788416", "SRR5788417", "SRR5788420", "SRR5788421", "SRR5788422"))  # Put Sample Type levels in chosen object to coincide with corresponding sample ID order
#Make the abundance plot by samples
phylum_colors<- brewer.pal(length(levels(rel_phyl_global_df$Phylum)),"Dark2")
global_rel_phyl_plot<-ggplot(rel_phyl_global_df, aes(x=Samples, y=Abundance, fill=Phylum)) +
geom_bar(aes(), stat="identity", position="stack") +
scale_fill_manual(values=phylum_colors) +
labs(x= "Muestras", y = "Abundancia relativa") +
facet_grid(~Zone, scales = "free_x")
ggsave("abund_rel_phyl_global.png", plot = global_rel_phyl_plot, width = 6.5, height = 3.65, units = "in", dpi = 400)
global_rel_phyl_plot
View(global_rel_phyl_plot)
View(phylum_global)
View(rel_phyl_global_df)
View(relative_phylum_global)
View(rel_phyl_global_df)
View(phylum_global)
View(phylum_global@tax_table@.Data)
View(phylum_global@otu_table@.Data)
?tax_glom
View(global)
View(global@otu_table@.Data)
View(global@tax_table@.Data)
View(global@sam_data)
?transform_sample_counts
#Relative abundance
phylum_global<- tax_glom(global, "Phylum") # Agglomerate at Phylum level
relative_phylum_global<- transform_sample_counts(phylum_global, function(x) x ) #Transform to relative abundance
rel_phyl_global_df<-psmelt(relative_phylum_global) # convert to data frame
rel_phyl_global_df$Phylum<- as.character(rel_phyl_global_df$Phylum) # convert to character type
rel_phyl_global_df$Phylum[rel_phyl_global_df$Abundance < 0.01] <- "Fila < 1% de abundancia" # Agglomerate in one name all the phyla with little abundance
rel_phyl_global_df$Phylum<- as.factor(rel_phyl_global_df$Phylum) # convert to factor type
rel_phyl_global_df$Samples<- factor(rel_phyl_global_df$Samples, levels = c("SRR5788415", "SRR5788416", "SRR5788417", "SRR5788420", "SRR5788421", "SRR5788422"))  # Put Sample Type levels in chosen object to coincide with corresponding sample ID order
#Make the abundance plot by samples
phylum_colors<- brewer.pal(length(levels(rel_phyl_global_df$Phylum)),"Dark2")
global_rel_phyl_plot<-ggplot(rel_phyl_global_df, aes(x=Samples, y=Abundance, fill=Phylum)) +
geom_bar(aes(), stat="identity", position="stack") +
scale_fill_manual(values=phylum_colors) +
labs(x= "Muestras", y = "Abundancia relativa") +
facet_grid(~Zone, scales = "free_x")
ggsave("abund_rel_phyl_global.png", plot = global_rel_phyl_plot, width = 6.5, height = 3.65, units = "in", dpi = 400)
#Relative abundance
phylum_global<- tax_glom(global, "Phylum") # Agglomerate at Phylum level
relative_phylum_global<- transform_sample_counts(phylum_global, function(x) x ) #Transform to relative abundance
rel_phyl_global_df<-psmelt(relative_phylum_global) # convert to data frame
rel_phyl_global_df$Phylum<- as.character(rel_phyl_global_df$Phylum) # convert to character type
rel_phyl_global_df$Phylum[rel_phyl_global_df$Abundance < 0.01] <- "Fila < 1% de abundancia" # Agglomerate in one name all the phyla with little abundance
rel_phyl_global_df$Phylum<- as.factor(rel_phyl_global_df$Phylum) # convert to factor type
rel_phyl_global_df$Samples<- factor(rel_phyl_global_df$Samples, levels = c("SRR5788415", "SRR5788416", "SRR5788417", "SRR5788420", "SRR5788421", "SRR5788422"))  # Put Sample Type levels in chosen object to coincide with corresponding sample ID order
rel_phyl_global_df$Phylum[rel_phyl_global_df$Abundance < 10] <- "Fila < 1% de abundancia" # Agglomerate in one name all the phyla with little abundance
#Relative abundance
phylum_global<- tax_glom(global, "Phylum") # Agglomerate at Phylum level
relative_phylum_global<- transform_sample_counts(phylum_global, function(x) x ) #Transform to relative abundance
rel_phyl_global_df<-psmelt(relative_phylum_global) # convert to data frame
View(rel_phyl_global_df)
rel_phyl_global_df_E <- rel_phyl_global_df %>%
filter(rel_phyl_global_df$Zone = "Epipelagic")
rel_phyl_global_df_E <- rel_phyl_global_df %>%
filter(rel_phyl_global_df$Zone == "Epipelagic")
View(rel_phyl_global_df_E)
rel_phyl_global_df_M <- rel_phyl_global_df %>%
filter(rel_phyl_global_df$Zone == "Mesopelagic")
rel_phyl_global_df_A <- rel_phyl_global_df %>%
filter(rel_phyl_global_df$Zone == "Abyssopelagic")
View(rel_phyl_global_df_E)
View(rel_phyl_global_df_M)
View(rel_phyl_global_df_A)
rel_phyl_global_df_E <- rel_phyl_global_df %>%
filter(rel_phyl_global_df$Zone == "Epipelagic") %>%
select(OTU, Sample, Abundance)
View(rel_phyl_global_df_E)
library(tydiverse)
library(tidyverse)
pivot_wider(rel_phyl_global_df_E, names_from = Sample, values_from = Abundance)
A<-pivot_wider(rel_phyl_global_df_E, names_from = Sample, values_from = Abundance)
View(A)
A<-pivot_wider(rel_phyl_global_df_E, names_from = OTU, values_from = Abundance)
rel_phyl_global_df$Phylum<- as.character(rel_phyl_global_df$Phylum) # convert to character type
rel_phyl_global_df$Phylum[rel_phyl_global_df$Abundance < 0.01] <- "Fila < 1% de abundancia" # Agglomerate in one name all the phyla with little abundance
rel_phyl_global_df$Phylum<- as.factor(rel_phyl_global_df$Phylum) # convert to factor type
rel_phyl_global_df$Samples<- factor(rel_phyl_global_df$Samples, levels = c("SRR5788415", "SRR5788416", "SRR5788417", "SRR5788420", "SRR5788421", "SRR5788422"))  # Put Sample Type levels in chosen object to coincide with corresponding sample ID order
#Make the abundance plot by samples
phylum_colors<- brewer.pal(length(levels(rel_phyl_global_df$Phylum)),"Dark2")
global_rel_phyl_plot<-ggplot(rel_phyl_global_df, aes(x=Samples, y=Abundance, fill=Phylum)) +
geom_bar(aes(), stat="identity", position="stack") +
scale_fill_manual(values=phylum_colors) +
labs(x= "Muestras", y = "Abundancia relativa") +
facet_grid(~Zone, scales = "free_x")
ggsave("abund_rel_phyl_global.png", plot = global_rel_phyl_plot, width = 6.5, height = 3.65, units = "in", dpi = 400)
#Relative abundance
phylum_global<- tax_glom(global, "Phylum") # Agglomerate at Phylum level
#relative_phylum_global<- transform_sample_counts(phylum_global, function(x) x / sum(x) ) #Transform to relative abundance
rel_phyl_global_df<-psmelt(phylum_global) # convert to data frame
rel_phyl_global_df_E <- rel_phyl_global_df %>%
filter(rel_phyl_global_df$Zone == "Epipelagic") %>%
select(OTU, Sample, Abundance)
rel_phyl_global_df_E <- rel_phyl_global_df %>%
filter(rel_phyl_global_df$Zone == "Epipelagic") %>%
select(OTU, Sample, Abundance) %>%
pivot_wider(names_from = OTU, values_from = Abundance)
relative_phylum_global<- transform_sample_counts(phylum_global, function(x) x / sum(x) ) #Transform to relative abundance
rel_phyl_global_df_M <- rel_phyl_global_df %>%
filter(rel_phyl_global_df$Zone == "Mesopelagic")%>%
select(OTU, Sample, Abundance) %>%
pivot_wider(names_from = OTU, values_from = Abundance)
rel_phyl_global_df_A <- rel_phyl_global_df %>%
filter(rel_phyl_global_df$Zone == "Abyssopelagic")%>%
select(OTU, Sample, Abundance) %>%
pivot_wider(names_from = OTU, values_from = Abundance)
library(phyloseq)
library(phyloseq)
library(ggplot2)
library(scales)
library(RColorBrewer)
library(ggpubr)
library(readr)
library(patchwork)
library(tidyverse)
# Read the biom file
raw_biom <- import_biom("~/dc_workshop/pocean_metagenome/data/pacific_ocean.biom")
#Give name to taxonomic categories
raw_biom@tax_table@.Data<-substring(raw_biom@tax_table@.Data,4)
colnames(raw_biom@tax_table@.Data)<- c("Kingdom","Phylum", "Class", "Order","Family", "Genus", "Species")
# Read metadata
metadatos<-read.csv("~/dc_workshop/pocean_metagenome/data/metadata_sampling.csv")
row.names(metadatos) <- metadatos$Samples
metadatos$Zone<-factor(metadatos$Zone, levels = c("Epipelagic", "Mesopelagic", "Abyssopelagic"))
# Generate otu_table
otu<-otu_table(raw_biom@otu_table@.Data, taxa_are_rows = TRUE)
colnames(otu) <-metadatos$Samples
# Generate taxonomy table
tax<-tax_table(raw_biom@tax_table@.Data)
# Generate metadata table
metad<-sample_data(metadatos)
# It is the complete phyloseq object with the 3 previous tables
global<-phyloseq(otu, tax, metad)
# Put the complete species names in the column for Species (instead of the epithet only)
global@tax_table@.Data[,7]<-paste(global@tax_table@.Data[,6], global@tax_table@.Data[,7], sep= "_")
# Agglomerate at Phylum level
phylum_global<- tax_glom(global, "Phylum")
#Relative abundance
relative_phylum_global<- transform_sample_counts(phylum_global, function(x) x / sum(x) ) #Transform to relative abundance
rel_phyl_global_df<-psmelt(relative_phylum_global) # convert to data frame
rel_phyl_global_df$Phylum<- as.character(rel_phyl_global_df$Phylum) # convert to character type
rel_phyl_global_df$Phylum[rel_phyl_global_df$Abundance < 0.01] <- "Fila < 1% de abundancia" # Agglomerate in one name all the phyla with little abundance
rel_phyl_global_df$Phylum<- as.factor(rel_phyl_global_df$Phylum) # convert to factor type
rel_phyl_global_df$Samples<- factor(rel_phyl_global_df$Samples, levels = c("SRR5788415", "SRR5788416", "SRR5788417", "SRR5788420", "SRR5788421", "SRR5788422"))  # Put Sample Type levels in chosen object to coincide with corresponding sample ID order
#Make the abundance plot by samples
phylum_colors<- brewer.pal(length(levels(rel_phyl_global_df$Phylum)),"Dark2")
global_rel_phyl_plot<-ggplot(rel_phyl_global_df, aes(x=Samples, y=Abundance, fill=Phylum)) +
geom_bar(aes(), stat="identity", position="stack") +
scale_fill_manual(values=phylum_colors) +
labs(x= "Muestras", y = "Abundancia relativa") +
facet_grid(~Zone, scales = "free_x")
ggsave("abund_rel_phyl_global.png", plot = global_rel_phyl_plot, width = 6.5, height = 3.65, units = "in", dpi = 400)
global_rel_phyl_plot
# Absolute abundance
abs_phyl_global_df<-psmelt(phylum_global) # convert to data frame
# Filter OTU table
abs_phyl_global_df_E <- abs_phyl_global_df %>%
filter(abs_phyl_global_df$Zone == "Epipelagic") %>%
select(OTU, Sample, Abundance) %>%
pivot_wider(names_from = OTU, values_from = Abundance)
abs_phyl_global_df_M <- abs_phyl_global_df %>%
filter(abs_phyl_global_df$Zone == "Mesopelagic")%>%
select(OTU, Sample, Abundance) %>%
pivot_wider(names_from = OTU, values_from = Abundance)
abs_phyl_global_df_A <- abs_phyl_global_df %>%
filter(abs_phyl_global_df$Zone == "Abyssopelagic")%>%
select(OTU, Sample, Abundance) %>%
pivot_wider(names_from = OTU, values_from = Abundance)
View(abs_phyl_global_df_A)
ggsave("abund_rel_phyl_global.svg", plot = global_rel_phyl_plot, width = 6.5, height = 3.65, units = "in", dpi = 400)
